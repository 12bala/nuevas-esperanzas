
id: profile

label: Migrate Csv Profile

migration_tags:
  - CSV

source:
  plugin: csv

  path: public://csv/profile.csv

  header_row_count: 1

  keys:
    - id

  column_names:

      0:
        id: Profile ID

      1:
        first_name: First Names

      2:
        last_name: Last Names

      3:
        other_event: Other event

      4:
        pictures: Pictures

      5:
        birthday: Birthday

      6:
        age: Age

      7:
        no_cedula: No. de Cedula

      8:
        marital_status: Marital status

      9:
        household_income: Household Income

      10:
        children: Children

      11:
        people_in_home: No. of People in Home

      12:
        employment1: Current Employment 1

      13:
        employment2: Current Employment 2

      14:
        salary: Salary

      15:
        telefono: Telefono

      16:
        highest_education_completed: Highest Education Completed

      17:
        read_write_math: Read Write Math

      18:
        special_skills: Special Skills

      19:
        job_training: Job Training

      20:
        languages: Languages


destination:
  plugin: entity:nica_entity

process:
  type:
    plugin: default_value
    default_value: profile

  title: first_name

  field_first_name: first_name

  field_last_name: last_name

  field_other_event: other_event

#  field_pictures : pictures

  field_birthday : birthday

  #field_age : age

  field_cedule_number: no_cedula

  field_marital_status:
    -
      plugin: static_map
      bypass: TRUE
      map:
        '': NULL
      source: marital_status
    -
      plugin: skip_on_empty
      method: process
    -
      plugin: migration
      migration: marital_status

  field_household_income: household_income

  field_children:
    -
      plugin: callback
      callable: strtoupper
    -
      plugin: static_map
      bypass: TRUE
      map:
        NO TIENE: 0
        NONE: 0
        NINGUNO: 0
        NINGUNA: 0

  field_number_of_people_in_home: people_in_home

  field_current_employment: employment1

  field_salary:
    -
      plugin: static_map
      bypass: TRUE
      source: salary
      map:
        '0,00': NULL
    -
      plugin: number_format
  field_telephone: telefono

  field_highest_education_complete:
    -
      plugin: static_map
      bypass: TRUE
      map:
        '': NULL
      source: highest_education_completed
    -
      plugin: skip_on_empty
      method: process
    -
      plugin: migration
      migration: highest_level_education

  field_read_write_math:
    -
      plugin: static_map
      bypass: TRUE
      map:
        '': NULL
      source: read_write_math
    -
      plugin: skip_on_empty
      method: process
    -
      plugin: migration
      migration: read_write_math

  field_special_skills:
    -
      plugin: static_map
      bypass: TRUE
      map:
        '': NULL
      source: special_skills
    -
      plugin: skip_on_empty
      method: process
    -
      plugin: migration
      migration: special_skills

  field_job_training:
    -
      plugin: static_map
      bypass: TRUE
      map:
        '': NULL
      source: job_training
    -
      plugin: skip_on_empty
      method: process
    -
      plugin: migration
      migration: job_training

  field_languages:
    -
      plugin: static_map
      bypass: TRUE
      source: languages
      map:
        '': Español
        Francés: 'Francés,Español'
        Inglés: 'Inglés,Español'
    -
      plugin: explode
      delimiter: ,
    -
      plugin: migration
      migration: languages
migration_dependencies:
  optional:
    - highest_level_education
    - job_training
    - languages
    - marital_status
    - read_write_math
    - special_skills
